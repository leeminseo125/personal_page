<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Calculator • Minseo Lee</title>
    <meta name="description" content="간단한 계산기 도구 (사칙연산)." />
    <link rel="stylesheet" href="../styles.css" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect rx='12' width='64' height='64' fill='%232563eb'/><text x='50%' y='54%' text-anchor='middle' font-family='Arial' font-weight='700' font-size='34' fill='white'>M</text></svg>">
    <style>
      .calc { max-width: 360px; margin: 36px auto; background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); }
      .calc .display { padding: 18px; border-bottom: 1px solid var(--border); text-align: right; color: var(--text); }
      .calc .expr { font-size: 14px; color: var(--muted); min-height: 20px; }
      .calc .result { font-size: 34px; line-height: 1.2; min-height: 42px; }
      .calc .row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; padding: 12px; }
      .calc button { padding: 14px 0; border-radius: 10px; border: 1px solid var(--border); background: #111315; color: var(--text); font-size: 16px; }
      .calc button.primary { background: var(--brand); color: var(--brand-contrast); border-color: var(--brand); }
      .calc button:focus-visible { outline: 3px solid var(--ring); outline-offset: 2px; }
      .calc .row.wide { grid-template-columns: repeat(2, 1fr); }
    </style>
  </head>
  <body>
    <header>
      <div class="container nav">
        <a class="brand" href="../">
          <div class="logo" aria-hidden="true"></div>
          <span class="brand-name">Minseo Lee</span>
        </a>
        <nav class="nav-links" aria-label="Primary">
          <a href="../">Home</a>
          <a href="../about.html">About</a>
          <a href="../contact.html">Contact</a>
          <a href="../docs/">Docs</a>
          <a class="active" href="./">Tech</a>
        </nav>
      </div>
    </header>

    <main class="container">
      <article class="prose" aria-label="Calculator">
        <h1>Calculator</h1>
        <div class="calc" role="application" aria-label="계산기">
          <div class="display">
            <div id="expr" class="expr">&nbsp;</div>
            <div id="result" class="result">0</div>
          </div>
          <div class="row">
            <button data-action="clear">AC</button>
            <button data-action="sign">±</button>
            <button data-action="percent">%</button>
            <button data-op="/">÷</button>
          </div>
          <div class="row">
            <button>7</button>
            <button>8</button>
            <button>9</button>
            <button data-op="*">×</button>
          </div>
          <div class="row">
            <button>4</button>
            <button>5</button>
            <button>6</button>
            <button data-op="-">−</button>
          </div>
          <div class="row">
            <button>1</button>
            <button>2</button>
            <button>3</button>
            <button data-op="+">+</button>
          </div>
          <div class="row">
            <button class="row-2" style="grid-column: span 2;">0</button>
            <button>.</button>
            <button class="primary" data-action="equals">=</button>
          </div>
        </div>
      </article>
    </main>

    <footer>
      <div class="container">© <span id="year"></span> Minseo Lee</div>
    </footer>

    <script>
      (function(){
        const exprEl = document.getElementById('expr');
        const resultEl = document.getElementById('result');
        let current = '0';
        let stored = null;
        let op = null;
        let lastEquals = false;
        const symbol = (o) => ({'/':'÷','*':'×','-':'−','+':'+'}[o] || o);
        const fmt = (n) => (Number.isFinite(+n) ? String(n) : 'Error');
        const expressionText = (showRight=true) => {
          const left = stored !== null ? String(stored) : '';
          const operator = op ? ' ' + symbol(op) + ' ' : '';
          const right = showRight ? current : '';
          return (left || operator) ? (left + operator + right) : right || '0';
        };
        const update = () => {
          exprEl.textContent = lastEquals ? exprEl.textContent : expressionText(false);
          resultEl.textContent = current;
        };
        const inputDigit = (d) => {
          if (lastEquals) { stored = null; op = null; current = '0'; lastEquals = false; }
          if (current === '0') current = d; else current += d;
          exprEl.textContent = expressionText();
          resultEl.textContent = current;
        };
        const inputDot = () => { if (!current.includes('.')) { current += '.'; exprEl.textContent = expressionText(); resultEl.textContent = current; } };
        const setOp = (nextOp) => {
          if (op && stored !== null && !lastEquals) equals(false);
          stored = parseFloat(current);
          current = '0';
          op = nextOp;
          lastEquals = false;
          exprEl.textContent = expressionText(false);
          resultEl.textContent = '0';
        };
        const clearAll = () => { current = '0'; stored = null; op = null; lastEquals = false; exprEl.textContent = '\u00A0'; resultEl.textContent = '0'; };
        const toggleSign = () => { if (current !== '0') { current = String(-parseFloat(current)); resultEl.textContent = current; exprEl.textContent = expressionText(); } };
        const percent = () => { current = String(parseFloat(current) / 100); resultEl.textContent = current; exprEl.textContent = expressionText(); };
        const equals = (mark=true) => {
          if (op && stored !== null) {
            const a = stored; const b = parseFloat(current);
            let res = 0;
            switch(op){ case '+': res = a + b; break; case '-': res = a - b; break; case '*': res = a * b; break; case '/': res = b === 0 ? NaN : a / b; break; }
            const result = fmt(res);
            if (mark) exprEl.textContent = expressionText(true) + ' =';
            current = result;
            stored = null; op = null; lastEquals = true;
            resultEl.textContent = current;
          }
        };
        document.addEventListener('click', (e) => {
          const t = e.target; if (!(t instanceof HTMLElement)) return;
          if (t.matches('button')) {
            const d = t.textContent?.trim();
            if (t.dataset.action === 'clear') return clearAll();
            if (t.dataset.action === 'sign') return toggleSign();
            if (t.dataset.action === 'percent') return percent();
            if (t.dataset.action === 'equals') return equals();
            if (t.dataset.op) return setOp(t.dataset.op);
            if (d === '.') return inputDot();
            if (/^\d$/.test(d || '')) return inputDigit(d || '');
          }
        });
        document.addEventListener('keydown', (e) => {
          const k = e.key;
          if (/^\d$/.test(k)) return inputDigit(k);
          if (k === '.') return inputDot();
          if (['+', '-', '*', '/'].includes(k)) return setOp(k);
          if (k === 'Enter' || k === '=') return equals();
          if (k === 'Escape') return clearAll();
        });
      })();
    </script>
  </body>
  </html>
